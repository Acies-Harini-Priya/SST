tables:
  - name: T_B2B_PACKAGE_STATUS
    sql: {{ load_sql('t_b2b_package_status') }}
    description: gives the status of the package
    public: true 

    dimensions:
      - name: BILLING_ACCOUNT_ID
        type: number
        column: BILLING_ACCOUNT_ID
        description: "ID"
        

      - name: CONTRACT_ID
        type: string
        column: CONTRACT_ID
        description: "ID"

      - name: CONTRACT_NUMBER
        type: string
        column: CONTRACT_NUMBER
        description: "identifier of the contract"

      - name: CREATED_BY  
        type: string
        column: CREATED_BY
        description: "name of the person who created "

      - name: CREATED_ON
        type: time
        column: CREATED_ON
        description: "creation datetime"

      - name: DS
        type: time
        column: DS
        description: "date column"
      
      - name: END_DATE
        type: time
        column: END_DATE
        description: "ending date"

      - name: EXTERNAL_ID
        type: number
        column: EXTERNAL_ID
        description: "ID"

      - name: LAST_MODIFIED_DATE
        type: time
        column: LAST_MODIFIED_DATE
        description: "date modified"

      - name: LOCATION_ID
        type: number
        column: LOCATION_ID
        description: "ID"

      - name: MRR
        type: number
        column: MRR
        description: "numeric value"

      - name: PACKAGE_SKU
        type: string
        column: PACKAGE_SKU
        description: "unique identifier  for package"
      
      - name: PACKAGE_STATUS_ID
        type: number
        column: PACKAGE_STATUS_ID
        description: "package status codes"

      - name: PACKAGE_STATUS_NAME
        type: string
        column: PACKAGE_STATUS_NAME
        description: "status of the package"
      
      - name: PLACE_TYPE
        type: string
        column: PLACE_TYPE
        description: "type of the place"
        
      - name: START_DATE
        type: time
        column: START_DATE
        description: "starting date"

      - name: SUBSCRIPTION_ID
        type: number
        column: SUBSCRIPTION_ID
        description: "ID"

      - name: UPDATED_BY
        type: string
        column: UPDATED_BY
        description: "name of person who updated"

      - name: UPDATED_ON
        type: time
        column: UPDATED_ON
        description: "datetime of updation"

    measures: 
      - name: TOTAL_MRR
        sql: MRR
        type: sum
        description: Total Monthly Recurring Revenue

      - name: TOTAL_CONTRACTS
        sql: "COUNT(Distinct {CONTRACT_ID})"
        type: number
        description: Number of unique contracts

      - name: AVG_MRR_PER_ACCOUNT
        sql: SUM(MRR) / COUNT(DISTINCT BILLING_ACCOUNT_ID)
        type: number
        description: Average revenue per billing account, used for ARPA (Average Revenue Per Account) metric

      - name: ACTIVE_PACKAGE_COUNT
        sql: COUNT(*) WHERE PACKAGE_STATUS_NAME = 'Active'
        type: number
        description: Count of currently active packages